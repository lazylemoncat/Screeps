{"code":"import { globalStructure } from \"@/global/GlobalStructure\";\r\nexport const roleHarvester = {\r\n    run: function (creep) {\r\n        // // if harvester's free capacity more than 0, harvest energy\r\n        // if (creep.memory.harvesting) {\r\n        //   goHarvest(creep);\r\n        // } else {\r\n        //   transferEnergy(creep);\r\n        // }\r\n        // if (creep.ticksToLive <= 30 && !creep.memory.dying) {\r\n        //   newOne(creep);\r\n        // }\r\n        if (creep.store.getFreeCapacity() == 0) {\r\n            transferEnergy(creep);\r\n        }\r\n        goHarvest(creep);\r\n    }\r\n};\r\nfunction goHarvest(creep) {\r\n    let source = globalStructure.sources[creep.memory.sourcesPosition];\r\n    if (!creep.pos.isNearTo(source)) {\r\n        creep.moveTo(source);\r\n        return;\r\n    }\r\n    let targetSource = globalStructure.sources[creep.memory.sourcesPosition];\r\n    if (targetSource.energy == 0)\r\n        return;\r\n    let container = globalStructure.containers.filter(structure => structure.pos.isNearTo(targetSource));\r\n    if (container[0] != undefined) {\r\n        if (container[0].store.getFreeCapacity(RESOURCE_ENERGY) == 0 &&\r\n            creep.getActiveBodyparts(CARRY) == 0) {\r\n            return;\r\n        }\r\n        if (!creep.pos.isEqualTo(container[0]) &&\r\n            creep.pos.isNearTo(targetSource)) {\r\n            creep.moveTo(container[0]);\r\n            return;\r\n        }\r\n    }\r\n    if (creep.harvest(targetSource) == ERR_NOT_IN_RANGE) {\r\n        if (global.harvestPath[creep.memory.sourcesPosition] == undefined) {\r\n            global.harvestPath[creep.memory.sourcesPosition] = creep.room.findPath(creep.pos, targetSource.pos);\r\n        }\r\n        creep.moveByPath(global.harvestPath[creep.memory.sourcesPosition]);\r\n    }\r\n}\r\nfunction transferEnergy(creep) {\r\n    let source = globalStructure.sources[creep.memory.sourcesPosition];\r\n    if (!creep.pos.isNearTo(source)) {\r\n        creep.moveTo(source);\r\n        return;\r\n    }\r\n    let link = creep.pos.findInRange(globalStructure.fromLinks, 1);\r\n    let container = creep.pos.findInRange(globalStructure.containers, 1);\r\n    if (creep.getActiveBodyparts(CARRY) != 0 &&\r\n        creep.store.getFreeCapacity(RESOURCE_ENERGY) == 0) {\r\n        if (link[0] != undefined) {\r\n            creep.transfer(link[0], RESOURCE_ENERGY);\r\n        }\r\n        else if (container[0] != undefined) {\r\n            creep.transfer(container[0], RESOURCE_ENERGY);\r\n        }\r\n        else {\r\n            creep.transferTo(creep);\r\n        }\r\n    }\r\n}\r\nfunction transfer(creep) {\r\n    let link = creep.pos.findInRange(globalStructure.fromLinks, 1)[0];\r\n    if (link != undefined) {\r\n        if (creep.transfer(link, RESOURCE_ENERGY) == OK) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    else {\r\n        let source = globalStructure.sources[creep.memory.sourcesPosition];\r\n        let container = globalStructure.containers.filter(structure => structure.pos.isNearTo(source))[0];\r\n        if (container != undefined) {\r\n            if (creep.transfer(container, RESOURCE_ENERGY) == OK) {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\n//# sourceMappingURL=RoleHarvester.js.map","references":["D:/Desktop/ScreepsCodes/World/src/global/GlobalStructure.ts","D:/Desktop/ScreepsCodes/World/src/NewCreep/NewCreepBodys.ts"],"map":"{\"version\":3,\"file\":\"RoleHarvester.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/Role/RoleHarvester.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,eAAe,EAAE,MAAM,0BAA0B,CAAC;AAG3D,MAAM,CAAC,MAAM,aAAa,GAAG;IAC3B,GAAG,EAAE,UAAS,KAAY;QACxB,8DAA8D;QAC9D,iCAAiC;QACjC,sBAAsB;QACtB,WAAW;QACX,2BAA2B;QAC3B,IAAI;QACJ,wDAAwD;QACxD,mBAAmB;QACnB,IAAI;QACJ,IAAI,KAAK,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,EAAE;YACtC,cAAc,CAAC,KAAK,CAAC,CAAC;SACvB;QACD,SAAS,CAAC,KAAK,CAAC,CAAC;IACpB,CAAC;CACD,CAAC;AAEF,SAAS,SAAS,CAAC,KAAY;IAC7B,IAAI,MAAM,GAAW,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;IAC3E,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;QAC/B,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QACrB,OAAO;KACR;IACD,IAAI,YAAY,GAAW,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;IACjF,IAAI,YAAY,CAAC,MAAM,IAAI,CAAC;QAAE,OAAO;IACrC,IAAI,SAAS,GAAG,eAAe,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAC5D,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,YAAsB,CAAC,CAAC,CAAC;IAClD,IAAI,SAAS,CAAC,CAAC,CAAC,IAAI,SAAS,EAAE;QAC7B,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,eAAe,CAAC,eAAe,CAAC,IAAI,CAAC;YACxD,KAAK,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;YACxC,OAAO;SACR;QACD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAClC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE;YACpC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YAC3B,OAAO;SACR;KACF;IAED,IAAG,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,gBAAgB,EAAE;QAClD,IAAI,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,IAAI,SAAS,EAAE;YACjE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,EAAE,YAAY,CAAC,GAAG,CAAC,CAAC;SACrG;QACD,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC;KACpE;AACH,CAAC;AAED,SAAS,cAAc,CAAC,KAAY;IAClC,IAAI,MAAM,GAAW,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;IAC3E,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;QAC/B,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QACrB,OAAO;KACR;IACD,IAAI,IAAI,GAAoB,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,eAAe,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;IAChF,IAAI,SAAS,GAAyB,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,eAAe,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;IAC3F,IAAI,KAAK,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC;QACpC,KAAK,CAAC,KAAK,CAAC,eAAe,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE;QACrD,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,SAAS,EAAE;YACxB,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,eAAe,CAAC,CAAC;SAC1C;aAAM,IAAI,SAAS,CAAC,CAAC,CAAC,IAAI,SAAS,EAAE;YACpC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,eAAe,CAAC,CAAC;SAC/C;aAAM;YACL,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;SACzB;KACF;AACH,CAAC;AAED,SAAS,QAAQ,CAAC,KAAY;IAC5B,IAAI,IAAI,GAAkB,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,eAAe,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACjF,IAAI,IAAI,IAAI,SAAS,EAAE;QACrB,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,eAAe,CAAC,IAAI,EAAE,EAAE;YAC/C,OAAO,IAAI,CAAC;SACb;aAAM;YACL,OAAO,KAAK,CAAC;SACd;KACF;SAAM;QACL,IAAI,MAAM,GAAW,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;QAC3E,IAAI,SAAS,GAAuB,eAAe,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAChF,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrC,IAAI,SAAS,IAAI,SAAS,EAAE;YAC1B,IAAI,KAAK,CAAC,QAAQ,CAAC,SAAS,EAAE,eAAe,CAAC,IAAI,EAAE,EAAE;gBACpD,OAAO,IAAI,CAAC;aACb;iBAAM;gBACL,OAAO,KAAK,CAAC;aACd;SACF;KACF;IACD,OAAO,KAAK,CAAC;AACf,CAAC\"}"}
