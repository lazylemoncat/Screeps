{"code":"import { globalStructure } from \"@/global/GlobalStructure\";\r\nexport const roleHarvester = {\r\n    run: function (creep) {\r\n        if (creep.store.getFreeCapacity() == 0) {\r\n            transferEnergy(creep);\r\n        }\r\n        goHarvest(creep);\r\n    }\r\n};\r\nfunction goHarvest(creep) {\r\n    let source = globalStructure.sources[creep.memory.sourcesPosition];\r\n    if (!creep.pos.isNearTo(source)) {\r\n        creep.moveTo(source);\r\n        return;\r\n    }\r\n    if (source.energy == 0 || creep.store.getFreeCapacity(RESOURCE_ENERGY) == 0) {\r\n        return;\r\n    }\r\n    let container = creep.pos.findInRange(globalStructure.containers, 1);\r\n    if (container[0] != undefined) {\r\n        if (container[0].store.getFreeCapacity(RESOURCE_ENERGY) == 0 &&\r\n            creep.getActiveBodyparts(CARRY) == 0) {\r\n            return;\r\n        }\r\n        if (!creep.pos.isEqualTo(container[0]) &&\r\n            creep.pos.isNearTo(source)) {\r\n            creep.moveTo(container[0]);\r\n            return;\r\n        }\r\n    }\r\n}\r\nfunction transferEnergy(creep) {\r\n    if (transfer(creep)) {\r\n        return;\r\n    }\r\n    else {\r\n        creep.transferTo(creep);\r\n    }\r\n}\r\nfunction transfer(creep) {\r\n    let link = creep.pos.findInRange(globalStructure.fromLinks, 1)[0];\r\n    if (link != undefined) {\r\n        if (creep.transfer(link, RESOURCE_ENERGY) == OK) {\r\n            return true;\r\n        }\r\n    }\r\n    let source = globalStructure.sources[creep.memory.sourcesPosition];\r\n    let container = globalStructure.containers.filter(structure => structure.pos.isNearTo(source))[0];\r\n    if (container != undefined) {\r\n        if (creep.transfer(container, RESOURCE_ENERGY) == OK) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n//# sourceMappingURL=RoleHarvester.js.map","references":["D:/Desktop/ScreepsCodes/World/src/global/GlobalStructure.ts","D:/Desktop/ScreepsCodes/World/src/NewCreep/NewCreepBodys.ts"],"map":"{\"version\":3,\"file\":\"RoleHarvester.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/Role/RoleHarvester.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,eAAe,EAAE,MAAM,0BAA0B,CAAC;AAG3D,MAAM,CAAC,MAAM,aAAa,GAAG;IAC3B,GAAG,EAAE,UAAS,KAAY;QACxB,IAAI,KAAK,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,EAAE;YACtC,cAAc,CAAC,KAAK,CAAC,CAAC;SACvB;QACD,SAAS,CAAC,KAAK,CAAC,CAAC;IACpB,CAAC;CACD,CAAC;AAEF,SAAS,SAAS,CAAC,KAAY;IAC7B,IAAI,MAAM,GAAW,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;IAC3E,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;QAC/B,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QACrB,OAAO;KACR;IACD,IAAI,MAAM,CAAC,MAAM,IAAI,CAAC,IAAI,KAAK,CAAC,KAAK,CAAC,eAAe,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE;QAC3E,OAAO;KACR;IACD,IAAI,SAAS,GAAG,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,eAAe,CAAC,UAAU,EAAE,CAAC,CAAC,CAAA;IACpE,IAAI,SAAS,CAAC,CAAC,CAAC,IAAI,SAAS,EAAE;QAC7B,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,eAAe,CAAC,eAAe,CAAC,IAAI,CAAC;YACxD,KAAK,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;YACxC,OAAO;SACR;QACD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAClC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YAC9B,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YAC3B,OAAO;SACR;KACF;AACH,CAAC;AAED,SAAS,cAAc,CAAC,KAAY;IAClC,IAAI,QAAQ,CAAC,KAAK,CAAC,EAAE;QACnB,OAAO;KACR;SAAM;QACL,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;KACzB;AACH,CAAC;AAED,SAAS,QAAQ,CAAC,KAAY;IAC5B,IAAI,IAAI,GAAkB,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,eAAe,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACjF,IAAI,IAAI,IAAI,SAAS,EAAE;QACrB,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,eAAe,CAAC,IAAI,EAAE,EAAE;YAC/C,OAAO,IAAI,CAAC;SACb;KACF;IACD,IAAI,MAAM,GAAW,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;IAC3E,IAAI,SAAS,GAAuB,eAAe,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAChF,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACrC,IAAI,SAAS,IAAI,SAAS,EAAE;QAC1B,IAAI,KAAK,CAAC,QAAQ,CAAC,SAAS,EAAE,eAAe,CAAC,IAAI,EAAE,EAAE;YACpD,OAAO,IAAI,CAAC;SACb;aAAM;YACL,OAAO,KAAK,CAAC;SACd;KACF;IACD,OAAO,KAAK,CAAC;AACf,CAAC\"}"}
