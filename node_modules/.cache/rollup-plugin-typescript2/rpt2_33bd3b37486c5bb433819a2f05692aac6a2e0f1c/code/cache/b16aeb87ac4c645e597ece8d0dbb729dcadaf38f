{"code":"export const tasks = {\r\n    withdraw: {\r\n        creep: [],\r\n        link: [],\r\n        container: [],\r\n        storage: [],\r\n    },\r\n    transfer: {\r\n        spawn: [],\r\n        extension: [],\r\n        tower: [],\r\n        container: [],\r\n        storage: [],\r\n    },\r\n    returnTransfer: function (room) {\r\n        findTransferTask(room);\r\n        let task = [];\r\n        for (let key in tasks.transfer) {\r\n            task = task.concat(tasks.transfer[key]);\r\n        }\r\n        return task;\r\n    },\r\n    returnWithdraw: function (room) {\r\n        findWithdraw(room);\r\n        let task = [];\r\n        for (let key in tasks.withdraw) {\r\n            task = task.concat(tasks.withdraw[key]);\r\n        }\r\n        return task;\r\n    },\r\n};\r\nfunction findWithdraw(room) {\r\n    linkTask('withdraw', room);\r\n    containerTask('withdraw', room);\r\n    storageTask('withdraw', room);\r\n}\r\nfunction findTransferTask(room) {\r\n    transferTask('spawn', room);\r\n    transferTask('extension', room);\r\n    transferTask('tower', room);\r\n    transferTask('container', room);\r\n    transferTask('storage', room);\r\n}\r\nfunction transferTask(type, room) {\r\n    let targets = room.structures.filter(structure => Game.getObjectById(structure).structureType == type &&\r\n        Game.getObjectById(structure).store.getFreeCapacity(RESOURCE_ENERGY) > 0);\r\n    for (let i = 0; i < targets.length; ++i) {\r\n        if (!tasks.transfer[type].includes(targets[i]) &&\r\n            Game.getObjectById(targets[i]).pos.findInRange(FIND_SOURCES, 2).length == 0) {\r\n            tasks.transfer[type].push(targets[i]);\r\n        }\r\n    }\r\n}\r\nfunction linkTask(task, room) {\r\n    switch (task) {\r\n        case 'withdraw': {\r\n            let links = room.toLinks;\r\n            for (let i = 0; i < room.toLinks.length; ++i) {\r\n                let link = Game.getObjectById(links[i]);\r\n                if (link.store[RESOURCE_ENERGY] > 100 && !tasks.withdraw.link.includes(link.id)) {\r\n                    tasks.withdraw.link.push(link.id);\r\n                }\r\n            }\r\n            break;\r\n        }\r\n    }\r\n}\r\nfunction containerTask(task, room) {\r\n    switch (task) {\r\n        case 'withdraw': {\r\n            let containers = room.containers;\r\n            for (let i = 0; i < containers.length; ++i) {\r\n                if (Game.getObjectById(containers[i]).pos.findInRange(FIND_SOURCES, 1).length != 0) {\r\n                    let container = Game.getObjectById(containers[i]);\r\n                    if (container.store[RESOURCE_ENERGY] >= 50 && !tasks.withdraw.container.includes(container.id)) {\r\n                        tasks.withdraw.container.push(container.id);\r\n                    }\r\n                }\r\n            }\r\n            break;\r\n        }\r\n    }\r\n}\r\nfunction storageTask(task, room) {\r\n    switch (task) {\r\n        case 'withdraw': {\r\n            let storage = Game.getObjectById(room.storage);\r\n            if (storage != undefined && !tasks.withdraw.storage.includes(storage.id) &&\r\n                storage.store[RESOURCE_ENERGY] >= 0) {\r\n                tasks.withdraw.storage.push(storage.id);\r\n            }\r\n            break;\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=Tasks.js.map","references":[],"map":"{\"version\":3,\"file\":\"Tasks.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/Tasks/Tasks.ts\"],\"names\":[],\"mappings\":\"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\"}"}
