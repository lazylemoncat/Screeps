{"code":"export const roleTransfer = {\r\n    run: function (creep) {\r\n        if (creep.memory.transfering && creep.store[RESOURCE_ENERGY] == 0) {\r\n            creep.memory.transfering = false;\r\n        }\r\n        if (!creep.memory.transfering && creep.store.getFreeCapacity() == 0) {\r\n            creep.memory.transfering = true;\r\n        }\r\n        if (backRoom(creep) == 0) {\r\n            return;\r\n        }\r\n        if (creep.memory.transfering) {\r\n            goTransfer(creep);\r\n        }\r\n        else {\r\n            goWithdraw(creep);\r\n        }\r\n    }\r\n};\r\nfunction backRoom(creep) {\r\n    if (creep.room != Game.spawns[\"Spawn1\"].room) {\r\n        creep.moveTo(Game.spawns[\"Spawn1\"]);\r\n        return 0;\r\n    }\r\n    else {\r\n        return -1;\r\n    }\r\n}\r\nfunction goTransfer(creep) {\r\n    let structures = creep.room.find(FIND_STRUCTURES);\r\n    let target = structures.filter(structure => (structure.structureType == STRUCTURE_EXTENSION ||\r\n        structure.structureType == STRUCTURE_SPAWN) &&\r\n        structure.store.getFreeCapacity(RESOURCE_ENERGY) > 0);\r\n    if (target[0] != undefined) {\r\n        if (creep.transfer(target[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(target[0]);\r\n        }\r\n        return;\r\n    }\r\n    target = structures.filter(structure => (structure.structureType == STRUCTURE_TOWER) &&\r\n        structure.store.getFreeCapacity(RESOURCE_ENERGY) > 0);\r\n    if (target[0] != undefined) {\r\n        if (creep.transfer(target[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(target[0]);\r\n        }\r\n        return;\r\n    }\r\n    target = structures.filter(structure => (structure.structureType == STRUCTURE_CONTAINER &&\r\n        structure.pos.isNearTo(structure.pos.findClosestByPath(FIND_SOURCES)) == false) ||\r\n        structure.structureType == STRUCTURE_STORAGE &&\r\n            structure.store.getFreeCapacity(RESOURCE_ENERGY) > 0);\r\n    if (creep.transfer(target[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n        creep.moveTo(target[0]);\r\n    }\r\n}\r\nfunction goWithdraw(creep) {\r\n    let targetSource = Game.getObjectById(creep.memory.sources);\r\n    let targetContainer = targetSource.pos.findClosestByPath(FIND_STRUCTURES, { filter: (structure) => (structure.structureType == STRUCTURE_CONTAINER) });\r\n    if (targetContainer == null || targetContainer.store[RESOURCE_ENERGY] == 0) {\r\n        targetContainer = creep.pos.findClosestByPath(FIND_STRUCTURES, { filter: (structure) => (structure.structureType == STRUCTURE_CONTAINER ||\r\n                structure.structureType == STRUCTURE_STORAGE) &&\r\n                structure.store[RESOURCE_ENERGY] > 0\r\n        });\r\n    }\r\n    if (creep.withdraw(targetContainer, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n        creep.moveTo(targetContainer);\r\n    }\r\n}\r\n//# sourceMappingURL=RoleTransfer.js.map","references":[],"map":"{\"version\":3,\"file\":\"RoleTransfer.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/Role/RoleTransfer.ts\"],\"names\":[],\"mappings\":\"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\"}"}
