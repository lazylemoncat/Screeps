{"code":"export const roleUpgrader = {\r\n    run: function (creep) {\r\n        if (creep.memory.upgrading && creep.store[RESOURCE_ENERGY] == 0) {\r\n            creep.memory.upgrading = false;\r\n        }\r\n        if (!creep.memory.upgrading && creep.store.getFreeCapacity() == 0) {\r\n            creep.memory.upgrading = true;\r\n        }\r\n        if (creep.memory.upgrading) {\r\n            isNearToTarget(creep);\r\n            goUpgrade(creep);\r\n        }\r\n        else {\r\n            goGetEnergy(creep);\r\n        }\r\n    }\r\n};\r\nfunction goUpgrade(creep) {\r\n    if (creep.upgradeController(creep.room.controller) == ERR_NOT_IN_RANGE) {\r\n        creep.moveTo(creep.room.controller);\r\n    }\r\n}\r\nfunction goGetEnergy(creep) {\r\n    let targetContainer = creep.pos.findClosestByPath(FIND_STRUCTURES, { filter: (structure) => (structure.structureType == STRUCTURE_CONTAINER ||\r\n            structure.structureType == STRUCTURE_STORAGE) &&\r\n            structure.store[RESOURCE_ENERGY] > 0 });\r\n    if (targetContainer == undefined) {\r\n        let target = creep.pos.findClosestByPath(FIND_SOURCES, { filter: (sources) => sources.energy > 0 });\r\n        if (creep.harvest(target) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(target);\r\n        }\r\n    }\r\n    else if (creep.withdraw(targetContainer, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n        creep.moveTo(targetContainer);\r\n    }\r\n}\r\nfunction isNearToTarget(creep) {\r\n    let closestSource = creep.pos.findClosestByPath(FIND_SOURCES);\r\n    if (creep.pos.isNearTo(closestSource)) {\r\n        creep.moveTo(creep.room.controller);\r\n    }\r\n}\r\n//# sourceMappingURL=RoleUpgrader.js.map","references":[],"map":"{\"version\":3,\"file\":\"RoleUpgrader.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/Role/RoleUpgrader.ts\"],\"names\":[],\"mappings\":\"AAAA,MAAM,CAAC,MAAM,YAAY,GAAG;IAC1B,GAAG,EAAE,UAAS,KAAY;QACxB,IAAG,KAAK,CAAC,MAAM,CAAC,SAAS,IAAI,KAAK,CAAC,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE;YAC9D,KAAK,CAAC,MAAM,CAAC,SAAS,GAAG,KAAK,CAAC;SAChC;QACD,IAAG,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,IAAI,KAAK,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,EAAE;YAChE,KAAK,CAAC,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC;SAC/B;QAED,IAAG,KAAK,CAAC,MAAM,CAAC,SAAS,EAAE;YACzB,cAAc,CAAC,KAAK,CAAC,CAAC;YACtB,SAAS,CAAC,KAAK,CAAC,CAAC;SAClB;aAAM;YACL,WAAW,CAAC,KAAK,CAAC,CAAC;SACpB;IACJ,CAAC;CACD,CAAC;AAEF,SAAS,SAAS,CAAC,KAAY;IAC7B,IAAG,KAAK,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,gBAAgB,EAAE;QACrE,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;KACrC;AACH,CAAC;AAED,SAAS,WAAW,CAAC,KAAY;IAC/B,IAAI,eAAe,GAAiB,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAC,eAAe,EAAE,EAAC,MAAM,EACtF,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC,SAAS,CAAC,aAAa,IAAI,mBAAmB;YAC9D,SAAS,CAAC,aAAa,IAAI,iBAAiB,CAAC;YAC7C,SAAS,CAAC,KAAK,CAAC,eAAe,CAAC,GAAG,CAAC,EAAC,CAAC,CAAC;IACzC,IAAI,eAAe,IAAI,SAAS,EAAE;QAChC,IAAI,MAAM,GAAW,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAC,YAAY,EAAC,EAAC,MAAM,EACnE,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAC,CAAC,CAAC;QACpC,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,gBAAgB,EAAE;YAC7C,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACtB;KACF;SAAM,IAAI,KAAK,CAAC,QAAQ,CAAC,eAAe,EAAE,eAAe,CAAC,IAAI,gBAAgB,EAAE;QAC/E,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;KAC/B;AACH,CAAC;AAED,SAAS,cAAc,CAAC,KAAY;IAClC,IAAI,aAAa,GAAW,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;IACtE,IAAI,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE;QACrC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,UAAiC,CAAC,CAAC;KAC5D;AACH,CAAC\"}"}
