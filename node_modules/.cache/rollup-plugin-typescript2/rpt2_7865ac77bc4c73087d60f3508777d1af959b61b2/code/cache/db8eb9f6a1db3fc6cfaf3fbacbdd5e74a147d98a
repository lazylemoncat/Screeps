{"code":"import { globalStructure } from \"@/global/GlobalStructure\";\r\nimport { newCreepBody } from \"@/NewCreep/NewCreepBodys\";\r\nimport { roleHarvester } from \"@/Role/RoleHarvester\";\r\nimport { roleTransfer } from \"@/Role/RoleTransfer\";\r\nexport const harvest = {\r\n    run: function () {\r\n        let harvesters = _.filter(Game.creeps, (creep) => creep.memory.role == 'harvester');\r\n        let transfers = _.filter(Game.creeps, (creep) => creep.memory.role == 'transfer');\r\n        newCreep(harvesters, transfers);\r\n        for (let i = 0; i < harvesters.length; ++i) {\r\n            roleHarvester.run(harvesters[i]);\r\n        }\r\n        for (let i = 0; i < transfers.length; ++i) {\r\n            roleTransfer.run(transfers[i]);\r\n        }\r\n    }\r\n};\r\nfunction newCreep(harvesters, transfers) {\r\n    let spawning = false;\r\n    if (harvesters.length < globalStructure.sources.length) {\r\n        spawning = newHarvester(harvesters);\r\n    }\r\n    if (!spawning && transfers.length < globalStructure.sources.length) {\r\n        newTransfer(transfers);\r\n    }\r\n}\r\nfunction newHarvester(harvesters) {\r\n    let newName = \"Harvester\" + Game.time;\r\n    let sourcesLength = globalStructure.sources.length;\r\n    let posFlag = 0;\r\n    for (let i = 0; i < sourcesLength; ++i) {\r\n        for (let j = 0; j < harvesters.length; ++j) {\r\n            if (i == harvesters[j].memory.sourcesPosition) {\r\n                posFlag += 1;\r\n                break;\r\n            }\r\n        }\r\n        if (posFlag == i)\r\n            break;\r\n    }\r\n    if (posFlag >= sourcesLength)\r\n        return false;\r\n    let isSpawning = Game.spawns['Spawn1'].spawnCreep(newCreepBody('harvester'), newName, { memory: { role: 'harvester', sourcesPosition: posFlag } }) == OK;\r\n    return isSpawning;\r\n}\r\nfunction newTransfer(transfers) {\r\n    let newName = 'Transfer' + Game.time;\r\n    let sourcesLength = globalStructure.sources.length;\r\n    let posFlag = 0;\r\n    for (let i = 0; i < sourcesLength; ++i) {\r\n        for (let j = 0; j < transfers.length; ++j) {\r\n            if (transfers[j].memory.sourcesPosition == i) {\r\n                posFlag += 1;\r\n                break;\r\n            }\r\n        }\r\n        if (posFlag == i)\r\n            break;\r\n    }\r\n    if (posFlag >= sourcesLength)\r\n        return false;\r\n    let isSpawning = Game.spawns['Spawn1'].spawnCreep(newCreepBody('transfer'), newName, { memory: {\r\n            role: 'transfer', sourcesPosition: posFlag,\r\n        } }) == OK;\r\n    return isSpawning;\r\n}\r\n//# sourceMappingURL=Harvest.js.map","references":["D:/Desktop/ScreepsCodes/World/src/global/GlobalStructure.ts","D:/Desktop/ScreepsCodes/World/src/NewCreep/NewCreepBodys.ts","D:/Desktop/ScreepsCodes/World/src/Role/RoleHarvester.ts","D:/Desktop/ScreepsCodes/World/src/Role/RoleTransfer.ts"],"map":"{\"version\":3,\"file\":\"Harvest.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/Tasks/Harvest.ts\"],\"names\":[],\"mappings\":\"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\"}"}
