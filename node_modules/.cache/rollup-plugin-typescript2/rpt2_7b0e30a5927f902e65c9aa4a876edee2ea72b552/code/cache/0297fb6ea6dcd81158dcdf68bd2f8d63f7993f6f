{"code":"import { globalStructure } from \"@/global/GlobalStructure\";\r\nexport const roleTransfer = {\r\n    run: function (creep) {\r\n        if (creep.memory.transfering && creep.store[RESOURCE_ENERGY] == 0) {\r\n            creep.memory.transfering = false;\r\n        }\r\n        if (!creep.memory.transfering && creep.store.getFreeCapacity() == 0) {\r\n            creep.memory.transfering = true;\r\n        }\r\n        if (backRoom(creep) == 0) {\r\n            return;\r\n        }\r\n        if (creep.memory.transfering) {\r\n            goTransfer(creep);\r\n        }\r\n        else {\r\n            goWithdraw(creep);\r\n        }\r\n    }\r\n};\r\nfunction backRoom(creep) {\r\n    if (creep.room != Game.spawns[\"Spawn1\"].room) {\r\n        creep.moveTo(Game.spawns[\"Spawn1\"]);\r\n        return 0;\r\n    }\r\n    else {\r\n        return -1;\r\n    }\r\n}\r\nfunction goTransfer(creep) {\r\n    let structures = creep.room.find(FIND_STRUCTURES);\r\n    let target = structures.filter(structure => (structure.structureType == STRUCTURE_EXTENSION ||\r\n        structure.structureType == STRUCTURE_SPAWN) &&\r\n        structure.store.getFreeCapacity(RESOURCE_ENERGY) > 0);\r\n    if (target[0] != undefined) {\r\n        let temp = creep.pos.findInRange(target, 3)[0];\r\n        if (temp != undefined) {\r\n            target[0] = temp;\r\n        }\r\n        if (creep.transfer(target[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(target[0]);\r\n        }\r\n        return;\r\n    }\r\n    target = structures.filter(structure => (structure.structureType == STRUCTURE_TOWER) &&\r\n        structure.store.getFreeCapacity(RESOURCE_ENERGY) > 0);\r\n    if (target[0] != undefined) {\r\n        let temp = creep.pos.findInRange(target, 6)[0];\r\n        if (temp != undefined) {\r\n            target[0] = temp;\r\n        }\r\n        if (creep.transfer(target[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(target[0]);\r\n        }\r\n        return;\r\n    }\r\n    target = structures.filter(structure => ((structure.structureType == STRUCTURE_CONTAINER &&\r\n        structure.pos.isNearTo(structure.pos.findClosestByPath(FIND_SOURCES)) == false) ||\r\n        structure.structureType == STRUCTURE_STORAGE) &&\r\n        structure.store.getFreeCapacity(RESOURCE_ENERGY) >= creep.store[RESOURCE_ENERGY]);\r\n    if (creep.transfer(target[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n        creep.moveTo(target[0]);\r\n    }\r\n}\r\nfunction goWithdraw(creep) {\r\n    if (globalStructure.toLinks.length > 0) {\r\n        if (globalStructure.toLinks[0].store[RESOURCE_ENERGY] >= 100) {\r\n            if (creep.withdraw(globalStructure.toLinks[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n                creep.moveTo(globalStructure.toLinks[0]);\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    let targetSource = globalStructure.sources[creep.memory.sourcesPosition];\r\n    let targetContainer = targetSource.pos.findClosestByPath(FIND_STRUCTURES, { filter: (structure) => (structure.structureType == STRUCTURE_CONTAINER) });\r\n    if (targetContainer == null ||\r\n        targetContainer.store[RESOURCE_ENERGY] <= creep.store.getFreeCapacity(RESOURCE_ENERGY)) {\r\n        targetContainer = creep.pos.findClosestByPath(FIND_STRUCTURES, { filter: (structure) => (structure.structureType == STRUCTURE_CONTAINER ||\r\n                structure.structureType == STRUCTURE_STORAGE) &&\r\n                structure.store[RESOURCE_ENERGY] >= creep.store.getFreeCapacity(RESOURCE_ENERGY)\r\n        });\r\n    }\r\n    if (creep.withdraw(targetContainer, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n        creep.moveTo(targetContainer);\r\n    }\r\n}\r\n//# sourceMappingURL=RoleTransfer.js.map","references":["D:/Desktop/ScreepsCodes/World/src/global/GlobalStructure.ts"],"map":"{\"version\":3,\"file\":\"RoleTransfer.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/Role/RoleTransfer.ts\"],\"names\":[],\"mappings\":\"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\"}"}
