{"code":"export const roleRepairer = {\r\n    run: function (creep) {\r\n        if (creep.memory.repairing && creep.store[RESOURCE_ENERGY] == 0) {\r\n            creep.memory.repairing = false;\r\n            global.repairerTarget = null;\r\n        }\r\n        else if (!creep.memory.repairing && creep.store.getFreeCapacity() == 0) {\r\n            creep.memory.repairing = true;\r\n        }\r\n        if (creep.memory.repairing) {\r\n            goRepair(creep);\r\n            backRoom(creep);\r\n        }\r\n        else {\r\n            goGetEnergy(creep);\r\n        }\r\n    }\r\n};\r\nfunction backRoom(creep) {\r\n    if (creep.room != Game.spawns[\"Spawn1\"].room) {\r\n        creep.moveTo(Game.spawns[\"Spawn1\"]);\r\n    }\r\n}\r\nfunction goRepair(creep) {\r\n    if (global.repairerTarget != null &&\r\n        global.repairerTarget.hits < global.repairerTarget.hitsMax) {\r\n        if (Game.getObjectById(global.repairerTarget.id).hits ==\r\n            Game.getObjectById(global.repairerTarget.id).hitsMax) {\r\n            global.repairerTarget = null;\r\n            return;\r\n        }\r\n        if (creep.repair(global.repairerTarget) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(global.repairerTarget);\r\n        }\r\n        return;\r\n    }\r\n    let injured = creep.room.find(FIND_STRUCTURES, {\r\n        filter: object => object.hits < object.hitsMax\r\n    });\r\n    let targetTo;\r\n    if (creep.room.find(FIND_STRUCTURES, { filter: structure => structure.structureType == STRUCTURE_TOWER })[0] != undefined) {\r\n        targetTo = injured.filter(structure => structure.structureType != STRUCTURE_WALL);\r\n    }\r\n    if (targetTo == undefined) {\r\n        targetTo = injured.sort((a, b) => a.hits - b.hits);\r\n    }\r\n    if (creep.store[RESOURCE_ENERGY] < creep.store.getCapacity(RESOURCE_ENERGY) / 2 &&\r\n        !creep.pos.inRangeTo(targetTo[0], 10)) {\r\n        creep.memory.repairing = false;\r\n        global.repairerTarget = null;\r\n        return;\r\n    }\r\n    global.repairerTarget = targetTo[0];\r\n    if (creep.repair(targetTo[0]) == ERR_NOT_IN_RANGE) {\r\n        creep.moveTo(targetTo[0]);\r\n    }\r\n}\r\nfunction goGetEnergy(creep) {\r\n    let targetEnergy = creep.pos.findClosestByPath(FIND_STRUCTURES, { filter: (structure) => {\r\n            return (structure.structureType == STRUCTURE_CONTAINER ||\r\n                structure.structureType == STRUCTURE_STORAGE)\r\n                && structure.store[RESOURCE_ENERGY] > 0;\r\n        } });\r\n    if (targetEnergy == null) {\r\n        let targetsource = creep.pos.findClosestByPath(FIND_SOURCES);\r\n        if (creep.harvest(targetsource) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(targetsource);\r\n        }\r\n    }\r\n    else {\r\n        if (creep.withdraw(targetEnergy, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(targetEnergy);\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=RoleRepairer.js.map","references":[],"map":"{\"version\":3,\"file\":\"RoleRepairer.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/Role/RoleRepairer.ts\"],\"names\":[],\"mappings\":\"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\"}"}
